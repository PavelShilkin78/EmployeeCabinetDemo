конст ВЕРСИЯ_ПРИЛОЖЕНИЯ = "version"
конст ИДЕНТИФИКАТОР_ПРИЛОЖЕНИЯ = "id"
конст УУИД_ПРИЛОЖЕНИЯ = "uuid"

@ВПроекте
исключение НеверныйФорматОтветаСервера    
;

структура ОшибкаJson
    обз знч code: Строка?
    обз знч value: Соответствие<Строка, Объект?>?
;

@ВПодсистеме
метод ПриложениеВJson(): Строка
    возврат СериализацияJson.ЗаписатьОбъект(
        {
            ВЕРСИЯ_ПРИЛОЖЕНИЯ: Проект.Версия.ВСтроку()
        }
    )
;

@ВПодсистеме
метод ПриложениеИзJson(Ответ: ОтветHttp): КлиентEssm.Приложение
    возврат СериализацияJson.ПрочитатьОбъект(Ответ.Тело, Тип<КлиентEssm.Приложение>)
;

@ВПодсистеме
метод ЭтоОшибкаНеизвестнаяВерсияПриложения(Ошибка: ЗапросыEssm.ИсключениеВыполненияЗапросаКEssm): Булево
    если Ошибка.КодСостояния != 400
        возврат Ложь
    ;
    
    знч ДанныеJson = СериализацияJson.ПрочитатьОбъект(Ошибка.ТелоОтвета, Тип<ОшибкаJson>)
    
    если ДанныеJson.code != "incorrectValue"
        возврат Ложь
    ;
    если ДанныеJson.value["fieldName"] != "version"
        возврат Ложь
    ;
    возврат Истина
;