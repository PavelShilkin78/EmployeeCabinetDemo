импорт КонтрольДоступа

//Область РазрешенияДоступа

@Обработчик
метод ВычислитьРазрешенияДоступа(): Массив<РазрешениеДоступа>
    возврат КонтрольДоступа.РегистрСведенийРедактированиеАдминистратору()
;

//КонецОбласти

@ВПодсистеме
метод ФункциональныеОпции(): Отпуск.ФункциональныеОпции
    пер ФункциональныеОпции: Отпуск.ФункциональныеОпции
    знч Запрос = Запрос{
        Выбрать 
            Функциональность, 
            Использование
        Из ИспользуемаяФункциональность}
    исп Результат = Запрос.Выполнить()
    для РезультатСтрока из Результат
        УстановитьЗначение(ФункциональныеОпции, РезультатСтрока.Функциональность, РезультатСтрока.Использование)
    ;
    возврат ФункциональныеОпции
;

метод УстановитьЗначение(ФункциональныеОпции: Отпуск.ФункциональныеОпции, 
    Функциональность: Функциональность, Значение: Булево)
    
    выбор Функциональность
    когда Отпуск
        ФункциональныеОпции.Отпуск = Значение
    когда ОтпускЗаСвойСчет
        ФункциональныеОпции.ОтпускЗаСвойСчет = Значение
    когда ИнформацияОбОтпусках
        ФункциональныеОпции.ИнформацияОбОтпусках = Значение
    когда ИнформацияОГрафикеОтпусков
        ФункциональныеОпции.ИнформацияОГрафикеОтпусков = Значение
    когда ЗаявленияНаКомпенсациюОтпуска
        ФункциональныеОпции.ЗаявленияНаКомпенсациюОтпуска = Значение
    когда ИспользоватьЕдиновременнуюВыплатуКОтпуску
        ФункциональныеОпции.ИспользоватьЕдиновременнуюВыплатуКОтпуску = Значение
    когда ИспользоватьМатериальнуюПомощьПриОтпуске
        ФункциональныеОпции.ИспользоватьМатериальнуюПомощьПриОтпуске = Значение
    когда ИнформацияОбОстаткахОтпусков
        ФункциональныеОпции.ИнформацияОбОстаткахОтпусков = Значение
    когда ОстаткиОтпусковПоРабочимМестам
        ФункциональныеОпции.ОстаткиОтпусковПоРабочимМестам = Значение
    когда ЗаявленияНаПереносОтпуска
        ФункциональныеОпции.ЗаявленияНаПереносОтпуска = Значение
    когда ЗаявленияНаОтменуОтпуска
        ФункциональныеОпции.ЗаявленияНаОтменуОтпуска = Значение          
    ;
;

@ВПодсистеме
метод ЗаписатьФункциональныеОпции(ФункциональныеОпции: Отпуск.ФункциональныеОпции) 
    ЗаписатьЗначение(Функциональность.Отпуск, ФункциональныеОпции.Отпуск)
    ЗаписатьЗначение(Функциональность.ОтпускЗаСвойСчет, ФункциональныеОпции.ОтпускЗаСвойСчет)  
    ЗаписатьЗначение(Функциональность.ИнформацияОбОтпусках, ФункциональныеОпции.ИнформацияОбОтпусках)  
    ЗаписатьЗначение(Функциональность.ИнформацияОГрафикеОтпусков, ФункциональныеОпции.ИнформацияОГрафикеОтпусков)  
    ЗаписатьЗначение(Функциональность.ЗаявленияНаКомпенсациюОтпуска, ФункциональныеОпции.ЗаявленияНаКомпенсациюОтпуска)  
    ЗаписатьЗначение(Функциональность.ИспользоватьЕдиновременнуюВыплатуКОтпуску, ФункциональныеОпции.ИспользоватьЕдиновременнуюВыплатуКОтпуску)
    ЗаписатьЗначение(Функциональность.ИспользоватьМатериальнуюПомощьПриОтпуске, ФункциональныеОпции.ИспользоватьМатериальнуюПомощьПриОтпуске)
    ЗаписатьЗначение(Функциональность.ИнформацияОбОстаткахОтпусков, ФункциональныеОпции.ИнформацияОбОстаткахОтпусков)
    ЗаписатьЗначение(Функциональность.ОстаткиОтпусковПоРабочимМестам, ФункциональныеОпции.ОстаткиОтпусковПоРабочимМестам)
    ЗаписатьЗначение(Функциональность.ЗаявленияНаПереносОтпуска, ФункциональныеОпции.ЗаявленияНаПереносОтпуска)
    ЗаписатьЗначение(Функциональность.ЗаявленияНаОтменуОтпуска, ФункциональныеОпции.ЗаявленияНаОтменуОтпуска)
;

метод ЗаписатьЗначение(Функциональность: Функциональность, Значение: Булево?)
    если Значение == Неопределено
        возврат
    ;  
    
    знч НаборЗаписей = новый ИспользуемаяФункциональность.НаборЗаписей()
		НаборЗаписей.Фильтр.Функциональность.Установить(Функциональность)
		НаборЗаписей.ДобавитьЗапись(
            Функциональность = Функциональность,
            Использование = Значение
        )
    НаборЗаписей.Записать()     
;