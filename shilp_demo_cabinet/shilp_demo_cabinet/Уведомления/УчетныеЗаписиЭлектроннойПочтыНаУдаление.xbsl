импорт Почта

@ВПодсистеме
метод ПереносДанныхУчетнойЗаписиПочты()
    пер ЗапросУчетныхЗаписей = Запрос{
        Выбрать Первые 1 
            Ссылка
         Из 
            УчетныеЗаписиПочты}
    знч Результат = новый ЧитаемыйМассив(ЗапросУчетныхЗаписей.Выполнить())
    если не Результат.Пусто()
        Почта.ЗаполнитьЭлектронныйАдресПочты()
        возврат
    ;
    знч Запрос = Запрос{
        Выбрать Первые 1 
            СерверИсходящейПочты,
            ПортСервераИсходящейПочты,
            Пользователь,
            Пароль,
            ИмяОтправителя,
            АдресЭлектроннойПочты,
            ИспользоватьЗащищенноеСоединениеДляИсходящейПочты
         Из 
            УчетныеЗаписиЭлектроннойПочтыНаУдаление
         Где
            ИспользоватьПоУмолчанию}
    знч РезультатСтроки = новый ЧитаемыйМассив(Запрос.Выполнить())
    если не РезультатСтроки.Пусто()
        пер ПочтаУчетнаяЗапись = новый УчетныеЗаписиПочты.Объект()
        ПочтаУчетнаяЗапись.ВладелецПочтыОбъект = Неопределено
        ПочтаУчетнаяЗапись.ВладелецПочтыПодсистема = Почта.ИД_ПОДСИСТЕМЫ
        ПочтаУчетнаяЗапись.Комментарий = "Учетная запись рассылки уведомлений"
        ПочтаУчетнаяЗапись.Наименование = РезультатСтроки[0].ИмяОтправителя
        ПочтаУчетнаяЗапись.СборПочты = Ложь
        ПочтаУчетнаяЗапись.СерверПочты = РезультатСтроки[0].СерверИсходящейПочты
        ПочтаУчетнаяЗапись.ПортСервераПочты = РезультатСтроки[0].ПортСервераИсходящейПочты
        ПочтаУчетнаяЗапись.УчетнаяЗапись = РезультатСтроки[0].Пользователь
        ПочтаУчетнаяЗапись.АдресЭлектроннойПочты = РезультатСтроки[0].АдресЭлектроннойПочты
        ПочтаУчетнаяЗапись.ПарольУчетнойЗаписи = РезультатСтроки[0].Пароль
        ПочтаУчетнаяЗапись.РазрешитьStartTls = Истина
        ПочтаУчетнаяЗапись.ИспользоватьЗащищенноеСоединение = РезультатСтроки[0].ИспользоватьЗащищенноеСоединениеДляИсходящейПочты
        ПочтаУчетнаяЗапись.Записать()
    ;
;