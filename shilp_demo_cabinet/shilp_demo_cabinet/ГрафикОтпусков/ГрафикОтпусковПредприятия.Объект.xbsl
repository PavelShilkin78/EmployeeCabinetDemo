импорт ОбщиеСтандартные

//Область ОбработчикиСобытий

@Обработчик
@ВыполнятьПриЗагрузкеДанных
метод ПриЗаполнении()  
    ЗаполнитьМоментСоздания()
;

@Обработчик
@ВыполнятьПриЗагрузкеДанных
метод ПередЗаписью(ПрежнееЗначение: ГрафикОтпусковПредприятия.Данные, ПараметрыЗаписи: ГрафикОтпусковПредприятия.ПараметрыЗаписи)
    ЗаполнитьПредставление()
    ЗаполнитьМоментСоздания()
;

@Обработчик
@ВыполнятьПриЗагрузкеДанных
метод ПередУдалением(ПараметрыУдаления: ГрафикОтпусковПредприятия.ПараметрыУдаления)
    МенеджерСущности.УдалитьПодчиненныеОбъекты(Ссылка, Тип<ГрафикОтпусковСтруктурнойЕдиницы>, "ГрафикОтпусковПредприятия")
;

@Обработчик
@ВыполнятьПриЗагрузкеДанных
метод ПослеЗаписи(ПредыдущееЗначение: ГрафикОтпусковПредприятия.Данные, ПараметрыЗаписи: ГрафикОтпусковПредприятия.ПараметрыЗаписи)
    исп КонтекстДоступа.Привилегированный()
    ГрафикОтпусковПредприятия.ПослеЗаписиДополнение(
        Ссылка,
        Год,
        Состояние,  
        ИнформационнаяСистемаИнициатор,
        ЭтоНовый(), 
        Состояние != ПредыдущееЗначение.Состояние
    )
;

//КонецОбласти

//Область СлужебныеПроцедурыИФункции

метод ЗаполнитьПредставление()
    ПредставлениеДокумента = "Сбор графиков отпусков на %{Год.ВСтроку()} г. от %{МоментСоздания.Представление()} "
;

метод ЗаполнитьМоментСоздания()
    если МоментСоздания == Неопределено
        МоментСоздания = Момент.Сейчас()
    ;
;

//КонецОбласти