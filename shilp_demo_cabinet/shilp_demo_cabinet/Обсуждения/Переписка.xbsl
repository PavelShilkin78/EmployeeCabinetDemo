импорт ИнтерфейсныеКомпонентыСтандартные

@Обработчик
метод ПослеСоздания()
    Инициализировать()
;

@ВПроекте
@Реализация
метод Инициализировать()
    ЗагрузитьОбсуждение()
    
    если Обсуждение != Неопределено
        ИнициализироватьЧат()
    ;
;

метод ЗагрузитьОбсуждение()
    если Обсуждение != Неопределено
        возврат
    ;
    
    если ПредметОбсуждения == Неопределено
        возврат
    ;
    
    Обсуждение = НайтиОбсуждениеПоПремету(ПредметОбсуждения)
;

метод ИнициализироватьЧат()
    Компоненты.КомпонентОбсуждения.УстановитьИдОбсуждения(ИдОбсуждения(Обсуждение))
;

метод ОтправитьПриНажатии(Источник: Кнопка, Событие: СобытиеПриНажатии)
    Обсуждение = Обсуждения.НовоеОбсуждениеПоПредмету(ПредметОбсуждения, ТекстСообщения)
    ИнициализироватьЧат()
;

@НаСервере @ДоступноСКлиента
статический метод ИдОбсуждения(Обсуждение: ДополнительныеДанныеОбсуждений.Ссылка): Ууид
    исп КонтекстДоступа.Привилегированный()
    возврат Обсуждение.ЗагрузитьОбъект().ИдОбсуждения
;

@НаСервере @ДоступноСКлиента
статический метод НайтиОбсуждениеПоПремету(ПредметОбсуждения: ПредметОбсуждения.Ссылка): ДополнительныеДанныеОбсуждений.Ссылка? 
    возврат Обсуждения.ОбсуждениеПредмета(ПредметОбсуждения)
;