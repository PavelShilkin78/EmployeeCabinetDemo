импорт ИнтерфейсныеКомпонентыСтандартные

@ВПодсистеме
метод Инициализировать()
    ИнтерфейсныеКомпоненты.ИнициализироватьПодчиненныеКомпоненты(Компоненты)
;


метод Записать(Источник: КоманднаяПанельФорм, Событие: СобытиеКомпонента)
    если не ПравилоСогласованияКорректно()
        возврат
    ;
    ЗаписатьПравилоСогласования(ПравилоСогласования)
    Закрыть(Истина)
;

метод Удалить(Источник: КоманднаяПанельФорм, Событие: СобытиеКомпонента)
    УдалитьПравилоСогласования(ПравилоСогласования)
    Закрыть(Истина)
;

метод Отменить(Источник: КоманднаяПанельФорм, Событие: СобытиеКомпонента)
    Закрыть(Ложь)
;

@НаСервере @ДоступноСКлиента
статический метод ЗаписатьПравилоСогласования(ПравилоСогласования: Согласования.ПравилоСогласования)
    Согласования.ЗаписатьПравилоСогласования(ПравилоСогласования)
;

@НаСервере @ДоступноСКлиента
статический метод УдалитьПравилоСогласования(ПравилоСогласования: Согласования.ПравилоСогласования)
    Согласования.УдалитьПравилоСогласования(ПравилоСогласования)
;

метод ПравилоСогласованияКорректно(): Булево
    если ПравилоСогласования.ТипПравила == ТипыПравилСогласования.ДляСотрудника
        для ШагСогласования из ПравилоСогласования.ШагиПравила
            если ШагСогласования.Согласующие.Содержит(ПравилоСогласования.ФизическоеЛицо)
                СтандартныеФормы.ПоказатьУведомление("Ошибка добавления правила",
                    "Сотрудник не может согласовывать свои заявления", ОценкаИнформации.Предупреждающая)
                возврат Ложь
            ;
        ;
    ;
    
    возврат Истина
;
метод ЗаписатьИЗакрытьВидимость(): Булево
    возврат ПравилоСогласования.ШагиПравила.Размер() > 0
;