импорт КонтрольДоступа

//Область РазрешенияДоступа

@Обработчик
метод ВычислитьРазрешенияДоступа(): Массив<РазрешениеДоступа>
    возврат КонтрольДоступа.РазрешенияДоступаТаблицыСервисныхДанныхАбонента()
;

//КонецОбласти

@ВПодсистеме 
метод УстановитьНастройки(Настройки: Статистика.НастройкиОтправки)
    пер Объект: НастройкиОтправкиСтатистики.Объект?
    знч Настройка = НастройкаОтправкиСтатистики()
    
    если Настройка == Неопределено
        Объект = новый НастройкиОтправкиСтатистики.Объект()     
    иначе
        Объект = Настройка.Ссылка.ЗагрузитьОбъект()  
    ;
    Объект.ОтправлятьКоличествоЛичныхКабинетов = Настройки.ОтправлятьКоличествоЛичныхКабинетов
    Объект.ОтправлятьОтчетыОбОшибках = Настройки.ОтправлятьОтчетыОбОшибках
    Объект.ОтправлятьСтатистикуВложений = Настройки.ОтправлятьСтатистикуВложений
    Объект.ОтправлятьСтатистикуДокументов = Настройки.ОтправлятьСтатистикуДокументов
    Объект.ОтправлятьСтатистикуРасчетныхЛистков = Настройки.ОтправлятьСтатистикуРасчетныхЛистков
    Объект.ОтправлятьСтатистикуСправочников = Настройки.ОтправлятьСтатистикуСправочников
    Объект.Записать()
;

@ВПодсистеме
метод НастройкаОтправкиСтатистики(): Статистика.НастройкиОтправки?
    пер Настройка: Статистика.НастройкиОтправки?
    знч Запрос = Запрос{
        Выбрать Первые 1 
            Ссылка как Ссылка,
            ОтправлятьКоличествоЛичныхКабинетов как ОтправлятьКоличествоЛичныхКабинетов,
            ОтправлятьСтатистикуСправочников как ОтправлятьСтатистикуСправочников,
            ОтправлятьСтатистикуДокументов как ОтправлятьСтатистикуДокументов,
            ОтправлятьСтатистикуРасчетныхЛистков как ОтправлятьСтатистикуРасчетныхЛистков,
            ОтправлятьСтатистикуВложений как ОтправлятьСтатистикуВложений,
            ОтправлятьОтчетыОбОшибках как ОтправлятьОтчетыОбОшибках   
        Породить НастройкаОтправкиСтатистики
        Из 
            НастройкиОтправкиСтатистики}
    для СтрокаРезультата из Запрос.Выполнить()
        Настройка = новый Статистика.НастройкиОтправки()
        Настройка.Ссылка = СтрокаРезультата.Ссылка
        Настройка.ОтправлятьКоличествоЛичныхКабинетов = СтрокаРезультата.ОтправлятьКоличествоЛичныхКабинетов
        Настройка.ОтправлятьОтчетыОбОшибках = СтрокаРезультата.ОтправлятьОтчетыОбОшибках
        Настройка.ОтправлятьСтатистикуВложений = СтрокаРезультата.ОтправлятьСтатистикуВложений
        Настройка.ОтправлятьСтатистикуДокументов = СтрокаРезультата.ОтправлятьСтатистикуДокументов
        Настройка.ОтправлятьСтатистикуРасчетныхЛистков = СтрокаРезультата.ОтправлятьСтатистикуРасчетныхЛистков
        Настройка.ОтправлятьСтатистикуСправочников = СтрокаРезультата.ОтправлятьСтатистикуСправочников
        прервать
    ;
    возврат Настройка
;