импорт ПоказателиСтатистики
импорт УниверсальныеМеханизмы

@ВПроекте
@НаСервере
структура НастройкиОтправки
    пер Ссылка: НастройкиОтправкиСтатистики.Ссылка?
    пер ОтправлятьКоличествоЛичныхКабинетов: Булево = Истина
    пер ОтправлятьСтатистикуСправочников: Булево = Истина
    пер ОтправлятьСтатистикуДокументов: Булево = Истина
    пер ОтправлятьСтатистикуРасчетныхЛистков: Булево = Истина
    пер ОтправлятьСтатистикуВложений: Булево = Истина
    пер ОтправлятьОтчетыОбОшибках: Булево = Истина   
;

@ВПроекте
@НаСервере
структура РезультатОтправки
    пер ОтправленаСтатистикаЛичныхКабинетов: Булево
    пер ОтправленаСтатистикаСправочников: Булево
    пер ОтправленаСтатистикаДокументов: Булево
    пер ОтправленаСтатистикаРасчетныхЛистков: Булево
    пер ОтправленаСтатистикаВложений: Булево
    пер ОтправленоОтчетовОбОшибках: Число
    пер ДатаОтправкиОбязательнойСтатистики: Момент?
    пер ДатаОтправкиДополнительнойСтатистики: Момент?
    пер ДатаОтправкиОтчетовОбОшибках: Момент?
;

@ВПроекте
@НаСервере
исключение ИсключениеПолученияНастроекОтправки
;

@ВПроекте
@НаСервере
исключение ИсключениеЗаписиНастроекОтправки
;

@ВПроекте
@НаСервере
метод ЛичныеКабинеты(): Массив<ПоказателиСтатистики.ЛичныеКабинеты>
    знч Сервисы = ПоставщикДанныхДляСервисаСтатистики.ПолучитьСервисы()
    знч Статистика: Массив<ПоказателиСтатистики.ЛичныеКабинеты>
    для Сервис из Сервисы
        Статистика.ДобавитьВсе(Сервис.СтатистикаЛичныхКабинетов())
    ;
    возврат Статистика
;

@ВПроекте
конст ИД_ПОДСИСТЕМЫ = "Статистика"

@ВПодсистеме
@НаСервере
метод Справочники(): Массив<СтатистикаДанных.Справочник>
     возврат СборСтатистикиРеализация.СправочникиСтатистика()
;

@ВПодсистеме 
@НаСервере
метод Документы(): Массив<СтатистикаДанных.Документ>
     возврат СборСтатистикиРеализация.ДокументыСтатистика()
; 

@ВПодсистеме 
@НаСервере
метод РасчетныеЛисты(): Массив<ПоказателиСтатистики.РасчетныеЛистки>
    знч Сервисы = ПоставщикДанныхДляСервисаСтатистики.ПолучитьСервисы()
    знч Статистика: Массив<ПоказателиСтатистики.РасчетныеЛистки>
    для Сервис из Сервисы
        Статистика.ДобавитьВсе(Сервис.СтатистикаРасчетныхЛистов())
    ;
    возврат Статистика
; 

@ВПодсистеме 
@НаСервере
метод Вложения(): Массив<ПоказателиСтатистики.Вложения>
     возврат СборСтатистикиРеализация.ВложенияСтатистика()
; 

@ВПодсистеме 
@НаСервере
метод ОшибкиПриложения(ДатаНачалаАнализа: Момент?): Массив<ПоказателиСтатистики.ОшибкаПриложения> 
     возврат СборСтатистикиРеализация.ОшибкиПриложения(ДатаНачалаАнализа)
;

@ВПодсистеме
@НаСервере
метод НастройкиОтправки(): НастройкиОтправки?
    возврат НастройкиОтправкиСтатистики.НастройкаОтправкиСтатистики()
;

@ВПодсистеме
@НаСервере
метод УстановитьНастройкиОтправки(Настройки: НастройкиОтправки)
    НастройкиОтправкиСтатистики.УстановитьНастройки(Настройки)
;

@ВПроекте
@НаСервере
метод ИнициализироватьОтправку()
    ОтправкаСтатистикиРеализация.ИнициализироватьОтправку()
;

@ВПодсистеме 
@НаСервере
метод РезультатОтправки(): РезультатОтправки
    возврат РезультатОтправкиСтатистики.РезультатОтправки()
;

@ВПодсистеме
@НаСервере
метод ОтправитьОбязательную()
    ОтправкаСтатистикиРеализация.ОтправитьОбязательнуюСтатистику()       
;

@ВПодсистеме
@НаСервере
метод ОтправитьДополнительную()
    ОтправкаСтатистикиРеализация.ОтправитьДополнительнуюСтатистику()      
;

@ВПодсистеме
@НаСервере
метод ОтправитьОтчетыОбОшибках()
    ОтправкаСтатистикиРеализация.ОтправитьОтчетыОбОщибках()      
;